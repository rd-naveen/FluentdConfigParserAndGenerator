# Suricata Alert Logs(JSON)
<source>
     @type tail
     path /var/log/suricata/eve-alerts.json
     pos_file /var/log/suricata/eve-alerts.json.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.suricata
     emit_unmatched_lines true
</source>

# Apache2 Error Logs
<source>
     @type tail
     path /var/log/apache2/error.log
     pos_file /var/log/apache2/error.log.pos
     <parse>
        @type apache_error
     </parse>
     path_key  tailed_path
     tag events.application.apache_error
     emit_unmatched_lines true
</source>

# Apache2 Access Logs
<source>
     @type tail
     path /var/log/apache2/access.log
     pos_file /var/log/apache2/access.log.pos
     <parse>
        @type apache2
     </parse>
     path_key  tailed_path
     tag events.application.apache_access
     emit_unmatched_lines true
</source>

# Zeek conn (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/conn.log
     pos_file /opt/zeek/logs/current/conn.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.conn
     emit_unmatched_lines true
</source>

# Zeek dns (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/dns.log
     pos_file /opt/zeek/logs/current/dns.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.dns
     emit_unmatched_lines true
</source>

# Zeek http (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/http.log
     pos_file /opt/zeek/logs/current/http.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.http
     emit_unmatched_lines true
</source>

# Zeek ssl (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/ssl.log
     pos_file /opt/zeek/logs/current/ssl.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.ssl
     emit_unmatched_lines true
</source>

# Zeek known_hosts (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/known_hosts.log
     pos_file /opt/zeek/logs/current/known_hosts.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.known_hosts
     emit_unmatched_lines true
</source>

# Zeek files (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/files.log
     pos_file /opt/zeek/logs/current/files.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.files
     emit_unmatched_lines true
</source>

# Zeek known_services (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/known_services.log
     pos_file /opt/zeek/logs/current/known_services.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.known_services
     emit_unmatched_lines true
</source>

# Zeek ntp (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/ntp.log
     pos_file /opt/zeek/logs/current/ntp.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.ntp
     emit_unmatched_lines true
</source>

# Zeek software (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/software.log
     pos_file /opt/zeek/logs/current/software.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.software
     emit_unmatched_lines true
</source>

# Zeek x509 (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/x509.log
     pos_file /opt/zeek/logs/current/x509.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.x509
     emit_unmatched_lines true
</source>

# Zeek dhcp (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/dhcp.log
     pos_file /opt/zeek/logs/current/dhcp.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.dhcp
     emit_unmatched_lines true
</source>

# Zeek pe (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/pe.log
     pos_file /opt/zeek/logs/current/pe.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.pe
     emit_unmatched_lines true
</source>

# Zeek quic (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/quic.log
     pos_file /opt/zeek/logs/current/quic.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.quic
     emit_unmatched_lines true
</source>

# Zeek weird (JSON)
<source>
     @type tail
     path /opt/zeek/logs/current/weird.log
     pos_file /opt/zeek/logs/current/weird.log.pos
     <parse>
        @type json
     </parse>
     path_key  tailed_path
     tag events.security.weird
     emit_unmatched_lines true
</source>




#events.application.apache_error filter
# <filter events.application.apache_error>
#       @type record_transformer
#       <record>
#          "hostname" ${record["host"]}
#          "source.ip" ${record["host"]}
#          "log.source"  ${tag}
#          "request.method" ${record["method"]}
#          "request.uri" ${record["path"]}
#          "request.response_code" ${record["code"]}
#          "response.size" ${record["size"]}
#          "request.referer" ${record["referer"]}
#          "request.user_agent" ${record["agent"]}
#      </record>
#        remove_keys method,host,code,referer,size,agent,path
# </filter>


# Security Evets Matcher
<match events.security.*>
     @type opensearch
         host coreserver
         port 9200
         user fluentd_sender
         password yBy62cVSrUBDXevQpVu$$
         logstash_format true
         logstash_prefix fluentd.${tag}
</match>

# Application Events Matcher
<match events.application.*>
     @type opensearch
         host coreserver
         port 9200
         user fluentd_sender
         password yBy62cVSrUBDXevQpVu$$
         logstash_format true
         logstash_prefix fluentd.${tag}
</match>




